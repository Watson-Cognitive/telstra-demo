+function(a){"use strict";var b,c=tcom.serviceQualifier={},d=0,e=9e4,f=1e3,g={services:{adborkey:"https://onlineshop.telstra.com.au/bundles/adborKey",autocomplete:"https://www.my.telstra.com.au/addresslookup/AutocompleteSearch",verifyAddress:"https://www.my.telstra.com.au/addresslookup/verifyAddress",qualification:"https://onlineshop.telstra.com.au/bundles/nbnServiceQualification"},keys:{adbor:"",storage:"serviceQualifier",results:{adsl:"isAdslAvailable","adsl2+":"isAdslAvailable",cable:"isCableAvailable",foxtel:"isFoxtelAvailable",foxtelTbox:"isFoxtelOnTboxAvailable",nbnFTTP:"isNbnAvailable",nbnFTTN:"isNbnAvailable",nbnFTTB:"isNbnAvailable",nbnHFC:"isNbnAvailable",nbnWireless:"nbnWirelessAvailable",none:"noneAvailable",error:"systemError",start:"startView"}},errors:{address:"Please enter the installation address.",postcode:"Please select an address from the dropdown list.",alertaddr:"Please enter your address to continue."},events:{complete:"sq:complete",error:"sq:error",reset:"sq:reset",addressError:"sq:addressError"},autoConfidenceLevel:90,ajaxTimeout:6e4},h={},i=function(b){a.ajax({type:"get",url:g.services.adborkey,cache:!1,dataType:"jsonp",jsonpCallback:"callback",success:function(a){g.keys.adbor=a.result,b&&b(a)},error:function(a){b&&b(a)}})},j=function(){return Modernizr.localstorage?JSON.parse(localStorage.getItem(g.keys.storage)):a.cookie(g.keys.storage)},k=function(b){Modernizr.localstorage?localStorage.setItem(g.keys.storage,JSON.stringify(b)):a.cookie(g.keys.storage,b,{expires:1,path:"/",domain:"telstra.com.au"})},l=function(c,h){return b||(b=setInterval(function(){d+=f},f)),0===g.keys.adbor.length?void(d<=e?i(function(){l(c,h)}):m()):(m(),void a.ajax({type:"get",url:g.services.verifyAddress,dataType:"jsonp",data:{address:c,postcode:h,excludeAddressType:"POSTAL",requestor:"PPA",key:g.keys.adbor},timeout:g.ajaxTimeout,success:n,error:function(){w(g.keys.results.error),a(".service-qualifier").trigger(g.events.error)}}))},m=function(){clearInterval(b),b=null,d=0},n=function(a){for(var b,c=0;c<a.length;c++)a[c].confidence>=g.autoConfidenceLevel&&(b=b?b.confidence<=a[c].confidence?a[c]:b:a[c]);b?(h.address=b,o(b.addressId)):v(a)},o=function(b){a.ajax({type:"get",url:g.services.qualification,dataType:"jsonp",data:{adborId:b},timeout:g.ajaxTimeout,success:function(a){"success"===a.status?(delete a.result.availableProducts,p(a.result)):w(g.keys.results.error)},error:function(){w(g.keys.results.error)}})},p=function(a){h.results=a,h.activeService=q(a),h.hideBuyNow=r(h.activeService),h.hideBuyNow?h.hideBuyNow="true"===h.hideBuyNow:h.hideBuyNow=!1,w(h.activeService),k(h)},q=function(b){var c,d=b.availableAccessMethods;for(var e in sqServicesConfig)if(c=e,b[g.keys.results[e]]){if(c.indexOf("nbn")>-1){if(c=c.replace(/^nbn/g,""),c="Wireless"===c?"NBN_WIRELESS":c,a.inArray(c,d)>-1)return e;continue}return e}return g.keys.results.none},r=function(a){return sqServicesConfig[a].hideBuyNow},s=function(){a(".service-qualifier").trigger(g.events.complete,[h])},t=!0,u=function(b){var c=a(".sq-search-view"),d=g.keys.results.start;c.find(".sq-title").text(sqServicesConfig[d].title),c.find(".sq-cta").first().text(sqServicesConfig[d].ctaLabel).removeClass("hide loading"),c.find("input").attr("disabled",!1).val(""),c.removeClass("hide"),b!==!0&&k(""),a(".sq-error-view").addClass("hide"),a(".sq-address-view").addClass("hide"),a(".sq-results-view").addClass("hide"),a(".service-qualifier").trigger(g.events.reset),a(".btn-search-reset").hide(),t=!1,m()},v=function(b){var c=a(".sq-search-view"),d=a(".sq-address-view"),e=d.find("select");a(".btn-search-reset").show(),c.removeClass("hide"),c.find(".btn").removeClass("loading"),a(".sq-search-intermediate-view").addClass("hide"),c.find("input").attr("disabled",!0),d.removeClass("hide"),d.find(".sq-cta").attr("disabled",!0),e.attr("disabled",!1),tcom.isMobile()?e.empty().append(a("<option />").val("").text("Find your address here")):e.empty().append(a("<option />").val("").text("Find your address here"));for(var f=0;f<b.length;f++)e.append(a("<option />").val(b[f].addressId).text(b[f].subaddress+" "+b[f].streetNumber+" "+b[f].streetName+", "+b[f].suburb).data("sq-address",b[f]))},w=function(b){var c=a(".sq-results-view");b===g.keys.results.none||b===g.keys.results.error?c.addClass("error"):c.removeClass("error"),c.find(".sq-title").html('<span class="td-icon-sm '+sqServicesConfig[b].titleIcon+'"></span><span>'+sqServicesConfig[b].title+"</span>"),c.find(".sq-message").html(sqServicesConfig[b].message);var d=a(".sq-cta-buttons");d.find(".sq-cta").remove(),sqServicesConfig[b].ctas&&"undefined"!=typeof sqServicesConfig[b].ctas.first&&d.append(x(sqServicesConfig[b].ctas.first,"first-cta do-business")),sqServicesConfig[b].ctas&&"undefined"!=typeof sqServicesConfig[b].ctas.second&&d.append(x(sqServicesConfig[b].ctas.second,"second-cta primary")),a(".sq-bottom-message").html(sqServicesConfig[b].bottomMessage),a(".sq-search-view").addClass("hide"),h.address?c.find(".sq-display-address").html("<strong>Your address: </strong><span>"+h.address.subaddress+" "+h.address.streetNumber+" "+h.address.streetName+" "+h.address.suburb+"</span>"):c.find(".sq-reset").remove(),a(".sq-search-intermediate-view").addClass("hide"),tcom.loadingIndicator(a(".indicator")).stop(),c.removeClass("hide"),s()},x=function(b,c){var d="btn sq-cta "+c,e=a("<a>",{"class":d});return b.ctaLabel&&e.text(b.ctaLabel),b.ctaScrollToId&&(e.attr("data-smoothscroll",""),e.attr("href",b.ctaScrollToId),e.attr("onclick","$('.modal').modal('hide');")),b.ctaCustomClass&&e.addClass(b.ctaCustomClass),b.ctaHref&&(b.isLightBox?e.attr({"data-toggle":"modal","data-target":b.ctaHref}):e.attr("href",b.ctaHref)),e},y=function(b,c){var d=new RegExp(/^( *\d+[A-Za-z\/\\-]*\d* *)*$/);d.test(b)||a.ajax({type:"get",url:g.services.autocomplete,dataType:"jsonp",data:{maxItems:5,requestor:"PPA",term:b},success:function(a){for(var b=/(<([^>]+)>)/gi,d=0;d<a.length;d++)a[d].value=a[d].value.replace(b,""),a[d].value=a[d].value.substring(0,a[d].value.length-6);c(a)}})};c.init=function(){function b(b,c,d){a(b).on("click",".sq-reset",u).on("typeahead:selected",".sq-search-view .tt-input",function(){return 0===c.val().length?void a(".sq-error-view").removeClass("hide").find("span").text(g.errors.address):0===d.val().length?void a(".sq-error-view").removeClass("hide").find("span").text(g.errors.postcode):(c.attr("disabled",!0),d.attr("disabled",!0),a(this).addClass("loading"),a(".sq-search-view").addClass("hide"),a(".sq-search-intermediate-view").removeClass("hide"),tcom.loadingIndicator(a(".indicator")).start(),void l(c.val(),d.val()))}).on("change",".sq-address-view select",function(){var b=a(this).parent().find("select"),c=b.val();h.address=b.find("[value="+c+"]").data("sq-address"),b.attr("disabled",!0),a(this).addClass("loading").attr("disabled",!0),a(".sq-search-view").addClass("hide"),a(".sq-search-intermediate-view").removeClass("hide"),o(c)}).on("change",".sq-address-view select",function(b){a(".sq-search-view .sq-cta:first").attr("disabled",!1);var c=b.currentTarget.selectedIndex;c>0?a(".sq-address-view .sq-cta").attr("disabled",!1):a(".sq-address-view .sq-cta").attr("disabled",!0)})}sessionStorage.clear();var c=localStorage.getItem("lastclear"),d=(new Date).getTime();null===c?localStorage.setItem("lastclear",d):d-c>864e5&&(localStorage.clear(),localStorage.setItem("lastclear",d)),i(),u(!0),a.cookie.json=!0;var e=j();e&&(e.activeService=q(e.results),w(q((h=e).results)),a(function(){s()}));var f=a("#sq-address, #sq-address-lightbox"),k=a("#sq-postcode, #sq-postcode-lightbox");f.typeahead({minLength:2,highlight:!0,hint:!1},{name:"sqSuggest",source:y,templates:{suggestion:function(a){return'<p class="needsclick">'+a.value+", "+a.postcode+"</p>"}}}),f.on("typeahead:selected",function(b,c){a(".sq-error-view").addClass("hide").find("span").text(""),k.val(c.postcode).attr("disabled",!0),a(".btn-search").attr("disabled",!1)}).on("typeahead:opened",function(){k.attr("disabled",!1)}).on("typeahead:closed",function(){t=!1}),b("#service-qualifier",a("#sq-address"),a("#sq-postcode")),b("#service-qualifier-lightbox",a("#sq-address-lightbox"),a("#sq-postcode-lightbox")),f.on("click",function(){if(!t&&a(this).val()){var b=a.Event("keydown");return b.keyCode=b.which=40,a(this).trigger(b),t=!0,!0}}).keypress(function(b){var c=b.which||b.keyCode;if(13===c)return a(".service-qualifier").find(".sq-search-view .tt-input").trigger("typeahead:selected"),a(this).typeahead("close"),!0});var m=a(".sq-error-view"),n=function(){a.trim(f.val()).length<=0&&(f.addClass("pulse"),m.removeClass("hide").find("span").text(g.errors.alertaddr),setTimeout(function(){f.removeClass("pulse").addClass("afterpulse"),m.addClass("hide"),a.trim(f.val()).length>0&&f.removeClass("afterpulse")},9e3)),f.keypress(function(){a(this).removeClass("pulse").removeClass("afterpulse"),m.addClass("hide")})};a(".service-qualifier").on(g.events.addressError,function(){n()})},c.init()}(jQuery),+function(a){"use strict";function b(a){for(var b=0,c=q.length;b<c;b++)if(a[q[b]])return a[q[b]];return null}function c(a){var b=parseInt(a.replace(" kbps",""),10);return isNaN(b)?0:Math.round(b/1e3)}function d(a){for(var b in speedIndicatorConfig){var c=speedIndicatorConfig[b];if(a>=c.min&&(a<c.max||!c.max))return c}}function e(a){var b={min:c(a.minimumSpeed),max:c(a.maximumSpeed),avg:c(a.estimatedSpeed)},e=d(b.avg);k.text(e.title),l.text(e.locationTitle),m.html(e.locationDesc.replace(/\[min\]/gi,b.min+"Mbps").replace(/\[max\]/gi,b.max+"Mbps").replace(/\[avg\]/gi,b.avg?b.avg+"Mbps":"1Mbps or less")),n.text(e.guideTitle),o.html(e.guideDesc.replace(/\[min\]/gi,b.min+"Mbps").replace(/\[max\]/gi,b.max+"Mbps").replace(/\[avg\]/gi,b.avg?b.avg+"Mbps":"1Mbps or less")),j.removeClass(),j.addClass(e.bracket),i.removeClass("hide")}function f(){i.addClass("hide"),j.removeClass(),k.text(""),l.text(""),m.text(""),n.text(""),o.text("")}function g(a,c){if("undefined"!=typeof speedIndicatorConfig&&"sq:complete"===a.type&&c&&c.activeService===p&&c.results&&c.results.speedInfo){var d=b(c.results.speedInfo);if(d)return void e(d)}f()}function h(){i.length&&a(window).on("sq:complete sq:error sq:reset",g)}var i=a("#sq-speed-indication"),j=i.find("#speed-indication-display"),k=i.find("#speed-title"),l=i.find("#speed-location-title"),m=i.find("#speed-location-desc"),n=i.find("#speed-guide-title"),o=i.find("#speed-guide-desc"),p="adsl",q=["ADSL2+","ADSL"];h()}(jQuery);